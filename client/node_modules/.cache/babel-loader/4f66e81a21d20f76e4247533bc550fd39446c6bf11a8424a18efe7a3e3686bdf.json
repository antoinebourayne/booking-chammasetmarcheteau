{"ast":null,"code":"import{useEffect,useState}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const deskLayout=[{id:1,top:'9%',left:'16%'},{id:2,top:'18%',left:'16%'},{id:3,top:'40%',left:'16%'},{id:4,top:'55%',left:'16%'},{id:5,top:'75%',left:'14%'},{id:6,top:'75%',left:'21%'},{id:7,top:'85%',left:'18%'},{id:8,top:'14%',left:'30%'},{id:9,top:'14%',left:'43%'},{id:10,top:'14%',left:'60%'},{id:11,top:'8%',left:'76%'},{id:12,top:'45%',left:'35%'},{id:13,top:'55%',left:'35%'},{id:14,top:'48%',left:'61%'}];function App(){const[desks,setDesks]=useState([]);const[selectedDesk,setSelectedDesk]=useState(null);const[currentUser,setCurrentUser]=useState(null);const[loginName,setLoginName]=useState('');const[error,setError]=useState('');const fetchDesks=()=>{axios.get('http://localhost:3001/api/availability').then(res=>setDesks(res.data)).catch(err=>console.error(err));};useEffect(()=>{if(currentUser)fetchDesks();},[currentUser]);if(!currentUser){return/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',marginTop:'100px'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Se connecter\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Nom\",value:loginName,onChange:e=>setLoginName(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{axios.get(\"http://localhost:3001/api/users?name=\".concat(encodeURIComponent(loginName))).then(res=>{setCurrentUser(res.data);setError('');}).catch(()=>setError(\"Utilisateur non trouvé\"));},children:\"Valider\"}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error})]});}const handleBooking=async deskId=>{try{await axios.post('http://localhost:3001/api/bookings',{user_id:currentUser.id,desk_id:deskId});setSelectedDesk(null);fetchDesks();}catch(err){alert('Erreur : ce bureau est déjà réservé');}};return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{width:'200px',backgroundColor:'#333',color:'white',display:'flex',flexDirection:'column',justifyContent:'space-between',padding:'1rem'},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h3\",{children:currentUser.name})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setCurrentUser(null);setLoginName('');setError('');},style:{backgroundColor:'#555',color:'white',border:'none',padding:'0.5rem',cursor:'pointer',width:'100%'},children:\"Se d\\xE9connecter\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative',width:800,height:600,margin:'2rem auto',overflow:'hidden',backgroundColor:'#DAD0D0'},children:[/*#__PURE__*/_jsx(\"img\",{src:\"/ballu5.svg\",alt:\"Floor Plan\",style:{width:'100%',height:'100%',position:'absolute',top:0,left:0}}),deskLayout.map(desk=>{var _status$user;const status=desks.find(d=>d.desk_id===desk.id);const booked=status===null||status===void 0?void 0:status.booked;const userName=status===null||status===void 0?void 0:(_status$user=status.user)===null||_status$user===void 0?void 0:_status$user.name;const isSelected=selectedDesk===desk.id;return/*#__PURE__*/_jsxs(\"div\",{onClick:()=>!booked&&setSelectedDesk(desk.id),style:{position:'absolute',top:desk.top,left:desk.left,width:'5%',height:'4%',backgroundColor:booked?'gray':'lightgreen',border:'2px solid black',borderRadius:'8px',display:'flex',alignItems:'center',justifyContent:'center',fontWeight:'bold',fontSize:'0.7rem',color:'black',textAlign:'center',padding:'2px',cursor:booked?'default':'pointer'},children:[booked?userName:'',isSelected&&/*#__PURE__*/_jsx(\"div\",{onClick:e=>{e.stopPropagation();handleBooking(desk.id);},style:{position:'absolute',top:'110%',left:'50%',transform:'translateX(-50%)',backgroundColor:'white',border:'1px solid black',borderRadius:'4px',padding:'2px 6px',fontSize:'0.7rem',cursor:'pointer',zIndex:2},children:\"R\\xE9server\"})]},desk.id);})]})]});}export default App;","map":{"version":3,"names":["useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","deskLayout","id","top","left","App","desks","setDesks","selectedDesk","setSelectedDesk","currentUser","setCurrentUser","loginName","setLoginName","error","setError","fetchDesks","get","then","res","data","catch","err","console","style","textAlign","marginTop","children","type","placeholder","value","onChange","e","target","onClick","concat","encodeURIComponent","color","handleBooking","deskId","post","user_id","desk_id","alert","display","width","backgroundColor","flexDirection","justifyContent","padding","name","border","cursor","position","height","margin","overflow","src","alt","map","desk","_status$user","status","find","d","booked","userName","user","isSelected","borderRadius","alignItems","fontWeight","fontSize","stopPropagation","transform","zIndex"],"sources":["/Users/antoinebourayne/Documents/booking-chammasetmarcheteau/client/src/App.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport axios from 'axios';\n\nconst deskLayout = [\n  { id: 1, top: '9%', left: '16%' },\n  { id: 2, top: '18%', left: '16%' },\n  { id: 3, top: '40%', left: '16%' },\n  { id: 4, top: '55%', left: '16%' },\n  { id: 5, top: '75%', left: '14%' },\n  { id: 6, top: '75%', left: '21%' },\n  { id: 7, top: '85%', left: '18%' },\n  { id: 8, top: '14%', left: '30%' },\n  { id: 9, top: '14%', left: '43%' },\n  { id: 10, top: '14%', left: '60%' },\n  { id: 11, top: '8%', left: '76%' },\n  { id: 12, top: '45%', left: '35%' },\n  { id: 13, top: '55%', left: '35%' },\n  { id: 14, top: '48%', left: '61%' },\n];\n\nfunction App() {\n  const [desks, setDesks] = useState([]);\n  const [selectedDesk, setSelectedDesk] = useState(null);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [loginName, setLoginName] = useState('');\n  const [error, setError] = useState('');\n\n  const fetchDesks = () => {\n    axios\n      .get('http://localhost:3001/api/availability')\n      .then(res => setDesks(res.data))\n      .catch(err => console.error(err));\n  };\n\n  useEffect(() => {\n    if (currentUser) fetchDesks();\n  }, [currentUser]);\n\n  if (!currentUser) {\n    return (\n      <div style={{ textAlign: 'center', marginTop: '100px' }}>\n        <h2>Se connecter</h2>\n        <input\n          type=\"text\"\n          placeholder=\"Nom\"\n          value={loginName}\n          onChange={(e) => setLoginName(e.target.value)}\n        />\n        <button\n          onClick={() => {\n            axios\n              .get(`http://localhost:3001/api/users?name=${encodeURIComponent(loginName)}`)\n              .then(res => {\n                setCurrentUser(res.data);\n                setError('');\n              })\n              .catch(() => setError(\"Utilisateur non trouvé\"));\n          }}\n        >\n          Valider\n        </button>\n        {error && <p style={{ color: 'red' }}>{error}</p>}\n      </div>\n    );\n  }\n\n  const handleBooking = async (deskId) => {\n    try {\n      await axios.post('http://localhost:3001/api/bookings', {\n        user_id: currentUser.id,\n        desk_id: deskId\n      });\n      setSelectedDesk(null);\n      fetchDesks();\n    } catch (err) {\n      alert('Erreur : ce bureau est déjà réservé');\n    }\n  };\n\n  return (\n    <div style={{ display: 'flex' }}>\n      {/* Sidebar */}\n      <div style={{\n    width: '200px',\n    backgroundColor: '#333',\n    color: 'white',\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'space-between',\n    padding: '1rem'\n  }}>\n    <div>\n      <h3>{currentUser.name}</h3>\n    </div>\n    <button \n      onClick={() => {\n        setCurrentUser(null);\n        setLoginName('');\n        setError('');\n      }}\n    style={{\n      backgroundColor: '#555',\n      color: 'white',\n      border: 'none',\n      padding: '0.5rem',\n      cursor: 'pointer',\n      width: '100%'\n    }}>\n      Se déconnecter\n    </button>\n  </div>\n\n      {/* Main content */}\n      <div\n        style={{\n          position: 'relative',\n          width: 800,\n          height: 600,\n          margin: '2rem auto',\n          overflow: 'hidden',\n          backgroundColor: '#DAD0D0'\n        }}\n      >\n        <img\n          src=\"/ballu5.svg\"\n          alt=\"Floor Plan\"\n          style={{\n            width: '100%',\n            height: '100%',\n            position: 'absolute',\n            top: 0,\n            left: 0\n          }}\n        />\n\n        {deskLayout.map(desk => {\n          const status = desks.find(d => d.desk_id === desk.id);\n          const booked = status?.booked;\n          const userName = status?.user?.name;\n          const isSelected = selectedDesk === desk.id;\n\n          return (\n            <div\n              key={desk.id}\n              onClick={() => !booked && setSelectedDesk(desk.id)}\n              style={{\n                position: 'absolute',\n                top: desk.top,\n                left: desk.left,\n                width: '5%',\n                height: '4%',\n                backgroundColor: booked ? 'gray' : 'lightgreen',\n                border: '2px solid black',\n                borderRadius: '8px',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                fontWeight: 'bold',\n                fontSize: '0.7rem',\n                color: 'black',\n                textAlign: 'center',\n                padding: '2px',\n                cursor: booked ? 'default' : 'pointer'\n              }}\n            >\n              {booked ? userName : ''}\n              {isSelected && (\n                <div\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    handleBooking(desk.id);\n                  }}\n                  style={{\n                    position: 'absolute',\n                    top: '110%',\n                    left: '50%',\n                    transform: 'translateX(-50%)',\n                    backgroundColor: 'white',\n                    border: '1px solid black',\n                    borderRadius: '4px',\n                    padding: '2px 6px',\n                    fontSize: '0.7rem',\n                    cursor: 'pointer',\n                    zIndex: 2\n                  }}\n                >\n                  Réserver\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}